var G=Object.defineProperty;var Q=(t,n,e)=>n in t?G(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var p=(t,n,e)=>Q(t,typeof n!="symbol"?n+"":n,e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function e(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=e(o);fetch(o.href,c)}})();let l;function $(t){return l=t.getContext("webgl2")}function J(t,n){const e=l.createShader(t);if(!e)return null;if(l.shaderSource(e,n),l.compileShader(e),!l.getShaderParameter(e,l.COMPILE_STATUS)){const o=l.getShaderInfoLog(e);return console.error(o),l.deleteShader(e),null}return e}function Z(t){const n=l.createProgram(),e=[];for(const o in t){const c=t[o],u=J(parseInt(o),c);if(!u){for(const f of e)l.deleteShader(f);return null}e.push(u)}for(const o of e)l.attachShader(n,o);l.linkProgram(n);for(const o of e)l.detachShader(n,o),l.deleteShader(o);if(!l.getProgramParameter(n,l.LINK_STATUS)){const o=l.getProgramInfoLog(n);return console.error(o),l.deleteProgram(n),null}return n}const E=Float32Array;function N(t=1,n=0,e=0,i=0,o=0,c,u=0,f=0,_=0,A=0,d,s=0,m=0,R=0,P=0,F){const a=new E(16);return a[0]=t,a[1]=n,a[2]=e,a[3]=i,a[4]=o,a[5]=t,a[6]=u,a[7]=f,a[8]=_,a[9]=A,a[10]=t,a[11]=s,a[12]=m,a[13]=R,a[14]=P,a[15]=t,a}function Y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t=0,n){const e=new E(2);return e[0]=t,e[1]=n??t,e}function z(t,n,e){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function I(t,n){return z(t,n,new E(2))}function j(t,n,e,i){return i[0]=t[0]+n[0]*e,i[1]=t[1]+n[1]*e,i}function L(t,n,e){return j(t,n,e,new E(2))}function O(t,n,e){return j(t,n,e,t)}function tt(t,n){const e=t[0],i=t[1];let o=e*e+i*i;return o>0&&(o=1/Math.sqrt(o)),n[0]=e*o,n[1]=i*o,n}function et(t){return tt(t,t)}function nt(t,n,e){return e[0]=-(n[1]-t[1]),e[1]=n[0]-t[0],e}function ot(t,n){return nt(t,n,new E(2))}function rt(t,n,e){const i=n[0],o=n[1],c=n[2];return e[12]=t[0]*i+t[4]*o+t[8]*c+t[12],e[13]=t[1]*i+t[5]*o+t[9]*c+t[13],e[14]=t[2]*i+t[6]*o+t[10]*c+t[14],e[15]=t[3]*i+t[7]*o+t[11]*c+t[15],e}function it(t,n,e){const i=n[0],o=n[1],c=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*c,e[9]=t[9]*c,e[10]=t[10]*c,e[11]=t[11]*c,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function C(t=0,n,e){const i=new E(3);return i[0]=t,i[1]=n??t,i[2]=e??t,i}class ct{constructor(){p(this,"position");p(this,"scale");p(this,"roll");p(this,"right");p(this,"up");p(this,"world_up");p(this,"projection");p(this,"view");p(this,"movement_speed");p(this,"roll_speed")}}function st(){const t=new ct;return t.position=g(),t.right=g(1,0),t.up=g(0,1),t.world_up=g(0,1),t.projection=N(1),t.view=N(1),t.scale=50,t.roll=0,t.movement_speed=.1,t.roll_speed=.1,t}function U(t,n){O(t.position,t.right,t.movement_speed*n)}function D(t,n){O(t.position,t.up,t.movement_speed*n)}function ut(t,n,e){return Y(t.projection),it(t.projection,C(t.scale/n,t.scale/e,1),t.projection),t.projection}function ft(t){return Y(t.view),rt(t.view,C(-t.position[0],-t.position[1],0),t.view),t.view}const y={keys:{},buttons:{},kb_key_down:function(){},kb_key_up:function(){},m_move:function(){},m_button_down:function(){},m_button_up:function(){},m_wheel_scroll:function(){}};function lt(){addEventListener("keydown",function(t){y.keys[t.code]=0,y.kb_key_down({code:t.code,alt:t.altKey,ctrl:t.ctrlKey,shift:t.shiftKey})}),addEventListener("keyup",function(t){y.keys[t.code]=1,y.kb_key_up({code:t.code,alt:t.altKey,ctrl:t.ctrlKey,shift:t.shiftKey})}),addEventListener("mousemove",function(t){y.m_move({x:t.offsetX,y:t.offsetY,xd:t.movementX,yd:t.movementY,button:t.button,alt:t.altKey,ctrl:t.ctrlKey,shift:t.shiftKey,target:t.target})}),addEventListener("mousedown",function(t){y.buttons[t.button]=0,y.m_button_down({x:t.offsetX,y:t.offsetY,xd:t.movementX,yd:t.movementY,button:t.button,alt:t.altKey,ctrl:t.ctrlKey,shift:t.shiftKey,target:t.target})}),addEventListener("mouseup",function(t){y.buttons[t.button]=1,y.m_button_up({x:t.offsetX,y:t.offsetY,xd:t.movementX,yd:t.movementY,button:t.button,alt:t.altKey,ctrl:t.ctrlKey,shift:t.shiftKey,target:t.target})}),addEventListener("wheel",function(t){y.m_wheel_scroll({xd:Math.sign(t.deltaX),yd:Math.sign(t.deltaY)})})}function b(t){return y.keys[t]===0}function K(t=0,n,e,i){const o=new E(4);return o[0]=t,o[1]=n??t,o[2]=e??t,o[3]=i,o}function M(t){return((t[0]&255)<<24|(t[1]&255)<<16|(t[2]&255)<<8|t[3]&255)>>>0}function at(t){const n=document.createElement("canvas");return t.append(n),n.width=t.clientWidth,n.height=t.clientHeight,addEventListener("resize",function(){n.width=t.clientWidth,n.height=t.clientHeight}),n}class _t{constructor(){p(this,"stride");p(this,"vertices");p(this,"indices")}}function k(t){return t.vertices.length/t.stride}function dt(t,n,e,i,o,c){const u=k(c),f=Math.PI*2/e,_=Math.PI/e,A=M(o);for(let d=0;d<e;d+=1){const s=I(t,g(Math.cos(f*d+_)*n,Math.sin(f*d+_)*n));c.vertices.push(...s,i,A)}for(let d=1;d<e-1;d+=1)c.indices.push(u,u+d,u+d+1)}function pt(t,n,e,i,o,c,u){const f=k(u),_=et(ot(e,t)),A=n/2,d=i/2,s=L(t,_,-3),m=L(t,_,A),R=L(e,_,d),P=L(e,_,-2),F=M(c);u.vertices.push(...s,o,F,...m,o,F,...R,o,F,...P,o,F),u.indices.push(f,f+1,f+2,f,f+2,f+3)}function ht(t,n,e,i,o,c,u){const f=k(u),_=Math.PI*2/i,A=Math.PI/i,d=M(c);for(let s=0;s<i;s+=1){const m=I(t,g(Math.cos(_*s+A)*e,Math.sin(_*s+A)*e)),R=I(t,g(Math.cos(_/2+_*s+A)*n,Math.sin(_/2+_*s+A)*n));u.vertices.push(...m,o,d,...R,o,d)}for(let s=1;s<i-1;s+=1)u.indices.push(f,f+s*2,f+s*2+2);for(let s=0;s<i;s+=1)u.indices.push(f+s*2,f+s*2+1,f+(s+1)*2%(i*2))}const T=at(document.body),r=$(T),x=Z({[r.VERTEX_SHADER]:`#version 300 es
        layout(location = 0) in vec3 i_position;
        layout(location = 1) in int i_color;
        uniform mat4 u_projection;
        uniform mat4 u_view;
        flat out int v_color;

        void main() {
            gl_Position = u_projection * u_view * vec4(i_position, 1.0);
            v_color = i_color;
        }
    `,[r.FRAGMENT_SHADER]:`#version 300 es
        precision highp float;
        flat in int v_color;
        out vec4 o_frag_color;

        vec4 unpack256(int packed) {
            return vec4(
                (packed >> 24) & 0xFF,
                (packed >> 16) & 0xFF,
                (packed >> 8) & 0xFF,
                packed & 0xFF
            ) / 255.0;
        }

        void main() {
            o_frag_color = unpack256(v_color);
        }
    `}),yt=r.getUniformLocation(x,"u_projection"),gt=r.getUniformLocation(x,"u_view");let w=[],B=[];const v=new _t;v.vertices=w;v.indices=B;v.stride=4;dt(g(),20,8,0,K(227,200,48,255),v);ht(g(),40,35,10,0,K(217,85,186,255),v);pt(g(0,-200),6,g(0),4,0,K(49,189,121,255),v);let At=B.length;const H=r.createVertexArray();r.bindVertexArray(H);const X=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,X);r.bufferData(r.ARRAY_BUFFER,null,r.STATIC_DRAW);r.enableVertexAttribArray(0);r.vertexAttribPointer(0,3,r.FLOAT,!1,16,0);r.enableVertexAttribArray(1);r.vertexAttribIPointer(1,1,r.INT,16,12);const V=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,V);r.bufferData(r.ELEMENT_ARRAY_BUFFER,null,r.STATIC_DRAW);const W=new ArrayBuffer(w.length*4),S=new DataView(W);for(let t=0;t<w.length;t+=4)S.setFloat32(t*4,w[t],!0),S.setFloat32(t*4+4,w[t+1],!0),S.setFloat32(t*4+8,w[t+2],!0),S.setInt32(t*4+12,w[t+3],!0);r.bindBuffer(r.ARRAY_BUFFER,X);r.bufferData(r.ARRAY_BUFFER,W,r.STATIC_DRAW);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,V);r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint32Array(B),r.STATIC_DRAW);const h=st();h.scale=5;h.movement_speed=2;lt();function wt(){b("KeyA")&&U(h,-1),b("KeyD")&&U(h,1),b("KeyS")&&D(h,-1),b("KeyW")&&D(h,1),b("KeyQ")&&(h.scale-=.1),b("KeyE")&&(h.scale+=.1),ut(h,T.width,T.height),ft(h)}r.enable(r.DEPTH_TEST);r.enable(r.BLEND);r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);function Et(){r.viewport(0,0,T.width,T.height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.useProgram(x),r.uniformMatrix4fv(yt,!1,h.projection),r.uniformMatrix4fv(gt,!1,h.view),r.bindVertexArray(H),r.drawElements(r.TRIANGLES,At,r.UNSIGNED_INT,0)}function q(){wt(),Et(),requestAnimationFrame(q)}q();
