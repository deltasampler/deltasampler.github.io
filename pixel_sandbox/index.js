(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();let m;function we(e){return m=e.getContext("webgl2")}function xe(e,t){const n=m.createShader(e);if(!n)return null;if(m.shaderSource(n,t),m.compileShader(n),!m.getShaderParameter(n,m.COMPILE_STATUS)){const s=m.getShaderInfoLog(n);return console.error(s),m.deleteShader(n),null}return n}function Ie(e){const t=m.createProgram(),n=[];for(const s in e){const o=e[s],l=xe(parseInt(s),o);if(!l){for(const c of n)m.deleteShader(c);return null}n.push(l)}for(const s of n)m.attachShader(t,s);m.linkProgram(t);for(const s of n)m.detachShader(t,s),m.deleteShader(s);if(!m.getProgramParameter(t,m.LINK_STATUS)){const s=m.getProgramInfoLog(t);return console.error(s),m.deleteProgram(t),null}return t}const g={keys:{},buttons:{},kb_key_down:function(){},kb_key_up:function(){},m_move:function(){},m_button_down:function(){},m_button_up:function(){},m_wheel_scroll:function(){}};function Se(e){g.kb_key_down=e}function De(e){g.m_move=e}function Oe(e){g.m_button_down=e}function Le(e){g.m_button_up=e}function Re(e){g.m_wheel_scroll=e}function ke(){addEventListener("keydown",function(e){g.keys[e.code]=0,g.kb_key_down({code:e.code,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,event:e})}),addEventListener("keyup",function(e){g.keys[e.code]=1,g.kb_key_up({code:e.code,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,event:e})}),addEventListener("mousemove",function(e){g.m_move({x:e.offsetX,y:e.offsetY,xd:e.movementX,yd:e.movementY,button:e.button,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,target:e.target,event:e})}),addEventListener("mousedown",function(e){g.buttons[e.button]=0,g.m_button_down({x:e.offsetX,y:e.offsetY,xd:e.movementX,yd:e.movementY,button:e.button,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,target:e.target,event:e})}),addEventListener("mouseup",function(e){g.buttons[e.button]=1,g.m_button_up({x:e.offsetX,y:e.offsetY,xd:e.movementX,yd:e.movementY,button:e.button,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,target:e.target,event:e})}),addEventListener("wheel",function(e){g.m_wheel_scroll({xd:Math.sign(e.deltaX),yd:Math.sign(e.deltaY),event:e})})}function V(e,t,n){return Math.min(Math.max(e,t),n)}function W(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function T(e,t,n){return t*n+e}const ae=Float32Array;function Ne(e=0,t){const n=new ae(2);return n[0]=e,n[1]=e,n}function Ae(e,t,n){return e[0]=t,e[1]=n,e}function j(e,t,n){return Math.min(Math.max(e,t),n)}var E=(e=>(e[e.PX=0]="PX",e[e.PCT=1]="PCT",e[e.FR=2]="FR",e))(E||{});const Ee={0:"px",1:"%",2:"fr"};class ze{}function z(e,t){const n=new ze;return n.x=e,n.u=t,n}function Pe(e){return`${e.x}${Ee[e.u]}`}class Xe{get(){return this.type===0?this.object[this.key]:this.call_get()}set(t){this.type===0?this.object[this.key]=t:this.call_set(t)}}function Q(e,t){const n=new Xe;return n.type=0,n.object=e,n.key=t,n}function Me(e){const t=Object.values(e);return t.slice(0,t.length/2).map(n=>String(n))}function Fe(e){const t=Object.keys(e);return t.slice(0,t.length/2).map(n=>Number(n))}function A(e,t){if(!e)return null;const n=document.createElement("span");return n.className="gui_label",n.innerHTML=e,t.append(n),n}function X(){const e=document.createElement("div");return e.className="gui_container",e}function G(e,t,n,i,s){const o=document.createElement("input");return o.className="gui_input",o.type=e,o.step=n.toString(),o.min=i.toString(),o.max=s.toString(),o.value=t.toString(),o}class y{constructor(){this.children=[]}container(){return this.ref_el}render(){}mount(){}static mount(){}update(){}}class re extends y{grid_str(t){let n="";for(let i=0;i<t.length;i+=1){const s=t[i];n+=Pe(s),i<t.length-1&&(n+=" ")}return n}layout_str(){let t="";const n=this.grid_x.length,i=this.grid_y.length,s=n*i;for(let o=0;o<s;o+=n){let l="";for(let c=o;c<o+n;c+=1){const r=this.layout[c];l+=`w${r}`,c<o+n-1&&(l+=" ")}t+=`"${l}"
`}return t}render(){const t=document.createElement("div");this.window_parent?t.className="gui_window":t.className="gui_window_root",this.window_children.length?(t.style.display="grid",t.style.gridTemplateColumns=this.grid_str(this.grid_x),t.style.gridTemplateRows=this.grid_str(this.grid_y),t.style.gridTemplateAreas=this.layout_str()):t.style.gridArea=`w${this.id}`,this.ref_el=t}}class q extends y{container(){return this.container_el}render(){const t=document.createElement("div");t.className="gui_collapsing_header"+(this.is_collapsed?" gui_is_collapsed":"");const n=document.createElement("div");n.className="gui_title",n.innerHTML=this.title,t.append(n),n.onclick=(function(){this.is_collapsed?(this.is_collapsed=!1,t.classList.remove("gui_is_collapsed")):(this.is_collapsed=!0,t.classList.add("gui_is_collapsed"))}).bind(this);const i=X();t.append(i),this.ref_el=t,this.container_el=i}}class Ue extends y{render(){const t=document.createElement("div");t.className="gui_text",t.innerHTML=this.value,this.ref_el=t}}class ue extends y{render(){const t=document.createElement("div");t.className="gui_bool";const n=document.createElement("div");n.className="gui_checkbox_group_option"+(this.value.get()?" gui_selected":""),n.innerHTML=this.label,t.append(n),n.onclick=(function(){this.value.get()?(this.value.set(!1),n.classList.remove("gui_selected")):(this.value.set(!0),n.classList.add("gui_selected")),this.onchange(this.value.get())}).bind(this),this.ref_el=t,this.input_el=n}update(){this.value.get()?this.input_el.classList.add("gui_selected"):this.input_el.classList.remove("gui_selected")}}class Ve extends y{render(){const t=document.createElement("div");t.className="gui_input_number",A(this.label,t);const n=G("number",this.value.get(),this.step,this.min,this.max);t.append(n),n.onchange=(function(){const i=j(parseFloat(n.value),this.min,this.max);this.value.set(i),n.value=i.toString(),this.onchange(i)}).bind(this),this.ref_el=t,this.input_el=n}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.value.get().toString())}}class _e extends y{render(){const t=document.createElement("div");t.className="gui_slider_number",A(this.label,t);const n=X();n.className="gui_input_range_container",t.append(n);const i=G("range",this.value.get(),this.step,this.min,this.max);i.className="gui_input_range",n.dataset.content=i.value,n.append(i),i.onchange=(function(){const s=j(parseFloat(i.value),this.min,this.max);this.value.set(s),n.dataset.content=i.value,this.onchange(s)}).bind(this),i.onmousemove=function(){n.dataset.content=i.value},this.ref_el=t,this.container_el=n,this.input_el=i}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.value.get().toString(),this.container_el.dataset.content=this.input_el.value)}}class Te extends y{render(){const t=document.createElement("div");t.className="gui_input_vec",t.style.setProperty("--size",this.size.toString()),A(this.label,t);const n=X();t.append(n);const i=[];for(let s=0;s<this.value.length;s+=1){const o=G("number",this.value[s],this.step,this.min,this.max);n.append(o),o.onchange=(function(){const l=j(parseFloat(o.value),this.min,this.max);this.value[s]=l,o.value=l.toString(),this.onchange(this.value)}).bind(this),i.push(o)}this.ref_el=t,this.input_els=i}update(){for(let t=0;t<this.value.length;t+=1){const n=this.input_els[t];document.activeElement!=n&&(n.value=this.value[t].toString())}}}class Ge extends y{to_hex(t,n,i){const s=this.mode===0?255:1,o=Math.round(t*s).toString(16).padStart(2,"0"),l=Math.round(n*s).toString(16).padStart(2,"0"),c=Math.round(i*s).toString(16).padStart(2,"0");return`#${o}${l}${c}`}from_hex(t){const n=t.replace(/^#/,""),i=this.mode===0?255:1,s=parseInt(n.substring(0,2),16)/i,o=parseInt(n.substring(2,4),16)/i,l=parseInt(n.substring(4,6),16)/i;return[s,o,l]}render(){const t=document.createElement("div");t.className="gui_color_edit"+(this.value.length===4?" gui_rgba":""),A(this.label,t);const n=X();t.append(n);const i=document.createElement("input");if(i.className="gui_input_color",i.type="color",i.value=this.to_hex(this.value[0],this.value[1],this.value[2]),n.append(i),i.onchange=(function(){const s=this.from_hex(i.value);this.value[0]=s[0],this.value[1]=s[1],this.value[2]=s[2],this.onchange(this.value)}).bind(this),this.value.length==4){const s=document.createElement("div");s.className="gui_input_range_container",n.append(s);const o=G("range",this.value[3],.01,0,1);o.className="gui_input_range",s.dataset.content=o.value,s.append(o),o.onchange=(function(){this.value[3]=parseFloat(o.value)*(this.mode===1?255:1),s.dataset.content=o.value,this.onchange(this.value)}).bind(this),o.onmousemove=function(){s.dataset.content=o.value},this.range_el=o,this.range_container_el=s}this.ref_el=t,this.input_el=i}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.to_hex(this.value[0],this.value[1],this.value[2])),this.range_container_el&&this.range_el&&document.activeElement!=this.range_el&&(this.range_el.value=this.value[3].toString(),this.range_container_el.dataset.content=this.range_el.value)}}class He extends y{render(){const t=document.createElement("div");t.className="gui_input_text",A(this.label,t);const n=document.createElement("input");n.className="gui_input",n.type="text",n.value=this.value.get().toString(),t.append(n),n.onchange=(function(){this.value.set(n.value),this.onchange(n.value)}).bind(this),this.ref_el=t,this.input_el=n}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.value.get().toString())}}class de extends y{render(){const t=document.createElement("div");t.className="gui_radio_group",A(this.label,t);const n=X();t.append(n);const i=[],s=this.value.get();for(let o=0;o<this.keys.length;o+=1){const l=this.keys[o],c=this.values[o],r=document.createElement("div");r.className="gui_radio_group_option"+(c===s?" gui_selected":""),r.innerHTML=l,n.append(r),r.onclick=(function(){this.value.set(c);for(const p of this.option_els)p.classList.remove("gui_selected");r.classList.add("gui_selected"),this.onchange(c)}).bind(this),i.push(r)}this.ref_el=t,this.option_els=i}update(){const t=this.value.get();for(let n=0;n<this.option_els.length;n+=1){const i=this.option_els[n];this.values[n]===t?i.classList.add("gui_selected"):i.classList.remove("gui_selected")}}}class Ke extends y{render(){const t=document.createElement("div");t.className="gui_checkbox_group",A(this.label,t);const n=X();t.append(n);const i=[],s=this.value.get();for(let o=0;o<this.keys.length;o+=1){const l=this.keys[o],c=this.values[o],r=document.createElement("div");r.className="gui_checkbox_group_option"+(s.indexOf(c)>-1?" gui_selected":""),r.innerHTML=l,n.append(r),r.onclick=(function(){r.classList.contains("gui_selected")?(s.splice(s.indexOf(c),1),r.classList.remove("gui_selected")):(s.push(c),r.classList.add("gui_selected")),this.onchange(this.value.get())}).bind(this),i.push(r)}this.ref_el=t,this.option_els=i}update(){const t=this.value.get();for(let n=0;n<this.option_els.length;n+=1){const i=this.option_els[n];t.indexOf(this.values[n])>-1?i.classList.add("gui_selected"):i.classList.remove("gui_selected")}}}class We extends y{render(){const t=document.createElement("div");t.className="gui_select",A(this.label,t);const n=document.createElement("div");n.className="gui_select",t.append(n),n.onclick=function(c){c.stopPropagation()};const i=document.createElement("div");i.className="gui_select_button",i.innerHTML="Select",n.append(i),i.onclick=function(){i.classList.contains("gui_open")?i.classList.remove("gui_open"):i.classList.add("gui_open")};const s=document.createElement("div");s.className="gui_select_container",n.append(s);const o=[],l=this.value.get();for(let c=0;c<this.keys.length;c+=1){const r=this.keys[c];this.values[c]===l&&(i.innerHTML=r);const d=document.createElement("div");d.className="gui_select_option",d.innerHTML=r,d.dataset.value=c.toString(),s.append(d),d.onclick=(function(){const v=this.values[parseInt(d.dataset.value||"")];this.value.set(v),i.innerHTML=r,i.classList.remove("gui_open"),this.onchange(v)}).bind(this),o.push(d)}this.ref_el=t,this.button_el=i,this.option_els=o}static mount(){const t=document.body.querySelector(".gui_window_root");t&&t.addEventListener("click",function(){const n=document.body.querySelector(".gui_select_button.gui_open");n&&n.classList.remove("gui_open")})}update(){const t=this.value.get();for(let n=0;n<this.option_els.length;n+=1)if(this.values[n]===t){this.button_el.innerHTML=this.keys[n];return}}}class he extends y{render(){const t=document.createElement("div");t.className="gui_button";const n=document.createElement("button");n.innerHTML=this.label,n.onclick=this.onclick,t.append(n),this.ref_el=t}}class fe extends y{render(){const t=document.createElement("div");t.className="gui_canvas";const n=this.canvas_el??document.createElement("canvas");t.append(n),this.auto_resize&&window.addEventListener("resize",function(){var i,s;n.width=((i=n.parentElement)==null?void 0:i.clientWidth)||0,n.height=((s=n.parentElement)==null?void 0:s.clientHeight)||0}),this.ref_el=t,this.canvas_el=n}mount(){var t,n;this.auto_resize&&(this.canvas_el.width=((t=this.canvas_el.parentElement)==null?void 0:t.clientWidth)||0,this.canvas_el.height=((n=this.canvas_el.parentElement)==null?void 0:n.clientHeight)||0)}}const Ce=[re,q,Ue,ue,Ve,_e,Te,Ge,He,de,Ke,We,he,fe];let ie=0;function J(e,t=""){const n=new re;return n.id=ie,n.title=t,n.grid_x=[],n.grid_y=[],n.layout=[],n.window_parent=e,n.window_children=[],n.parent=e,e&&(e.children.push(n),e.window_children.push(n)),ie+=1,n}function $e(e,t,n){e.grid_x=t,e.grid_y=n}function Be(e,t){const n=[];for(const i of t)n.push(i.id);e.layout=n}function me(e,t,n=!1){const i=new q;return i.title=t,i.is_collapsed=n,i.parent=e,e&&e.children.push(i),i}function je(e,t,n,i=()=>{}){const s=new ue;return s.label=t,s.value=n,s.onchange=i,s.parent=e,e&&e.children.push(s),s}function Qe(e,t,n,i,s,o,l=()=>{}){const c=new _e;return c.label=t,c.value=n,c.step=i,c.min=s,c.max=o,c.onchange=l,c.parent=e,e&&e.children.push(c),c}function qe(e,t,n,i,s,o=()=>{}){const l=new de;return l.label=t,l.value=n,l.keys=i,l.values=s,l.onchange=o,l.parent=e,e&&e.children.push(l),l}function Je(e,t,n){const i=new he;return i.label=t,i.onclick=n,i.parent=e,e&&e.children.push(i),i}function Ze(e,t=!0){const n=new fe;return n.auto_resize=t,n.parent=e,e&&e.children.push(n),n}function Z(e,t){e.render(),t.append(e.ref_el),e.mount();for(const n of e.children)Z(n,e.container())}function Ye(e){var i;if(!((i=e.parent)==null?void 0:i.ref_el))return;const n=e.ref_el;e.render(),n.replaceWith(e.ref_el),e.mount();for(const s of e.children)Z(s,e.container())}function et(e,t,n=!0){if(Z(e,t),!!n)for(const i of Ce)i.mount()}function Y(e){if(!(e instanceof q&&e.is_collapsed)){e.update();for(const t of e.children)Y(t)}}function D(e=0,t,n){const i=new ae(3);return i[0]=e,i[1]=t??e,i[2]=n??e,i}function x(e){return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255}var u=(e=>(e[e.VOID=0]="VOID",e[e.SOLID=1]="SOLID",e[e.LIQUID=2]="LIQUID",e[e.GAS=3]="GAS",e))(u||{});class L{}function M(e,t){e.type=t.type,e.color=t.color,e.state=t.state,e.gravity_flag=t.gravity_flag,e.density=t.density,e.lifetime=t.lifetime,e.temperature=t.temperature}var _=(e=>(e[e.EMPTY=0]="EMPTY",e[e.STONE=1]="STONE",e[e.WOOD=2]="WOOD",e[e.SAND=3]="SAND",e[e.DENSE_SAND=4]="DENSE_SAND",e[e.WATER=5]="WATER",e[e.OIL=6]="OIL",e[e.AIR=7]="AIR",e[e.FIRE=8]="FIRE",e))(_||{});const tt={0:D(235,235,235),1:D(99,99,99),2:D(161,102,47),3:D(247,201,136),4:D(209,155,105),5:D(82,133,235),6:D(77,75,38),7:D(169,205,222),8:D(255,92,51)};function I(e){return tt[e]}function P(e){const t=new L;return t.id=e,t.type=0,t.color=x(I(t.type)),t.state=u.VOID,t.gravity_flag=!1,t.density=0,t.lifetime=0,t}function nt(e){const t=new L;return t.id=e,t.type=1,t.color=x(I(t.type)),t.state=u.SOLID,t.gravity_flag=!1,t.density=1,t.lifetime=0,t}function it(e){const t=new L;return t.id=e,t.type=2,t.color=x(I(t.type)),t.state=u.SOLID,t.gravity_flag=!1,t.density=1,t.lifetime=0,t}function st(e){const t=new L;return t.id=e,t.type=3,t.color=x(I(t.type)),t.state=u.SOLID,t.gravity_flag=!0,t.density=2,t.lifetime=0,t}function ot(e){const t=new L;return t.id=e,t.type=4,t.color=x(I(t.type)),t.state=u.SOLID,t.gravity_flag=!0,t.density=1,t.lifetime=0,t}function lt(e){const t=new L;return t.id=e,t.type=5,t.color=x(I(t.type)),t.state=u.LIQUID,t.gravity_flag=!0,t.density=3,t.lifetime=0,t}function ct(e){const t=new L;return t.id=e,t.type=6,t.color=x(I(t.type)),t.state=u.LIQUID,t.gravity_flag=!0,t.density=4,t.lifetime=0,t}function at(e){const t=new L;return t.id=e,t.type=7,t.color=x(I(t.type)),t.state=u.GAS,t.gravity_flag=!0,t.density=4,t.lifetime=0,t}function rt(e){const t=new L;return t.id=e,t.type=8,t.color=x(I(t.type)),t.state=u.GAS,t.gravity_flag=!0,t.density=4,t.lifetime=400,t}class ut{}function _t(e,t){const n=e*t,i=new ut;i.width=e,i.height=t,i.size=n,i.elements=new Array(n),i.buffer=new Uint8Array(n*3);for(let s=0;s<n;s+=1){const o=P(s);i.elements[s]=P(s),i.buffer[s*3]=o.color>>16&255,i.buffer[s*3+1]=o.color>>8&255,i.buffer[s*3+2]=o.color&255}return i}function F(e,t){return e.elements[t]}function se(e,t){return e.elements[(t-1+e.size)%e.size]}function oe(e,t){return e.elements[(t+1)%e.size]}function le(e,t){return e.elements[(t+e.width)%e.size]}function dt(e,t){return e.elements[(t-e.width+e.size)%e.size]}function H(e,t){return e.elements[(t-1+e.width)%e.size]}function ht(e,t){return e.elements[(t-1-e.width+e.size)%e.size]}function K(e,t){return e.elements[(t+1+e.width)%e.size]}function ft(e,t){return e.elements[(t+1-e.width+e.size)%e.size]}function b(e,t,n){e.elements[t.id]=n,e.elements[n.id]=t;const i=t.id;t.id=n.id,n.id=i}const mt=P(0);let ce=0;function pt(e){ce+=1;for(let t=e.height-1;t>=0;t-=1){const n=Math.random()<.5;for(let i=0;i<e.width;i+=1){const s=T(n?i:e.width-1-i,t,e.width),o=F(e,s),l=le(e,s),c=n?H(e,s):K(e,s),r=n?K(e,s):H(e,s),p=se(e,s),d=oe(e,s);o.state!==u.VOID&&(!o.gravity_flag||s>=e.size-e.width-1||(o.state===u.SOLID&&(l.state===u.VOID?b(e,o,l):c.state===u.VOID?b(e,o,c):r.state===u.VOID?b(e,o,r):l.density>o.density&&l.gravity_flag&&b(e,o,l)),o.state===u.LIQUID&&(l.state===u.VOID?b(e,o,l):c.state===u.VOID?b(e,o,c):r.state===u.VOID?b(e,o,r):l.density>o.density&&l.gravity_flag?b(e,o,l):p.state===u.VOID?b(e,o,p):d.state===u.VOID?b(e,o,d):p.density>o.density&&p.gravity_flag&&p.state===u.LIQUID?b(e,o,p):d.density>o.density&&d.gravity_flag&&d.state===u.LIQUID&&b(e,o,d))))}}for(let t=0;t<e.height;t+=1){const n=Math.random()<.5;for(let i=0;i<e.width;i+=1){const s=T(n?i:e.width-1-i,t,e.width),o=F(e,s),l=se(e,s),c=oe(e,s),r=dt(e,s),p=ht(e,s),d=ft(e,s),v=le(e,s),ye=H(e,s),be=K(e,s);if(o.state!==u.VOID){if(o.type===_.FIRE){o.lifetime-=W(-1,8);const h=[l,c,r,p,d,v,ye,be],f=h[W(0,h.length-1)];(f.type===_.WOOD||f.type===_.OIL)&&Math.random()>.5&&(M(f,o),f.color=x(C(I(f.type),16)),f.lifetime=200),(o.lifetime<=0||f.type===_.WATER)&&M(o,mt)}if(ce%4!==0)return;if(!(!o.gravity_flag||s<e.width)&&!(v.type===_.WOOD||v.type===_.OIL)&&o.state===u.GAS){const h=[];r.state===u.VOID&&h.push(r),p.state===u.VOID&&h.push(p),d.state===u.VOID&&h.push(d),r.density<o.density&&r.gravity_flag&&h.push(r),l.state===u.VOID&&h.push(l),c.state===u.VOID&&h.push(c),l.density<o.density&&l.gravity_flag&&l.state===u.GAS&&h.push(l),c.density<o.density&&c.gravity_flag&&c.state===u.GAS&&h.push(c),Math.random()<.05&&v.state===u.VOID&&h.push(v);for(let f=h.length-1;f>0;f--){const ne=Math.floor(Math.random()*(f+1));[h[f],h[ne]]=[h[ne],h[f]]}for(let f=0;f<h.length;f++)if(h[f]!==null){b(e,o,h[f]);break}}}}}}function gt(e){for(let t=0;t<e.size;t+=1){const n=F(e,t);e.buffer[t*3]=n.color>>16&255,e.buffer[t*3+1]=n.color>>8&255,e.buffer[t*3+2]=n.color&255}}function C(e,t){const n=W(-16,t),i=V(e[0]+n,0,255),s=V(e[1]+n,0,255),o=V(e[2]+n,0,255);return D(i,s,o)}function vt(e,t,n,i,s){if(s<=1){const o=T(n,i,e.width),l=F(e,o);if(!l)return;M(l,t),l.type!==_.EMPTY&&(l.color=x(C(I(l.type),16)))}else{const o=Math.floor(s/2);for(let l=-o;l<=o;l++)for(let c=-o;c<=o;c++){const r=n+c,p=i+l;if(!(r<0||r>=e.width||p<0||p>=e.height)&&c*c+l*l<=o*o){const d=T(r,p,e.width),v=F(e,d);if(!v)continue;M(v,t),v.type!==_.EMPTY&&(v.color=x(C(I(v.type),16)))}}}}function pe(e,t){for(const n of e.elements)M(n,t)}const U=J(null);$e(U,[z(300,E.PX),z(1,E.FR),z(300,E.PX)],[z(1,E.FR),z(1,E.FR),z(1,E.FR)]);const N=J(U),R=J(U);Be(U,[N,R,R,N,R,R,N,R,R]);const yt=Ze(R,!1);et(U,document.body);const k=R.ref_el,S=yt.canvas_el;let $=k.clientWidth<k.clientHeight?k.clientWidth:k.clientHeight;S.width=S.height=$;addEventListener("resize",function(){$=k.clientWidth<k.clientHeight?k.clientWidth:k.clientHeight,S.width=S.height=$});const a=we(S),bt=Ie({[a.VERTEX_SHADER]:`#version 300 es
        out vec2 v_tex_coord;

        const vec2 positions[4] = vec2[](
            vec2(-1.0, 1.0),
            vec2(-1.0, -1.0),
            vec2(1.0, 1.0),
            vec2(1.0, -1.0)
        );

        const vec2 tex_coords[4] = vec2[](
            vec2(0.0, 0.0),
            vec2(0.0, 1.0),
            vec2(1.0, 0.0),
            vec2(1.0, 1.0)
        );

        void main() {
            gl_Position = vec4(positions[gl_VertexID], 0.0, 1.0);
            v_tex_coord = tex_coords[gl_VertexID];
        }
    `,[a.FRAGMENT_SHADER]:`#version 300 es
        precision highp float;
        out vec4 o_frag_color;
        in vec2 v_tex_coord;
        uniform sampler2D u_texture;

        void main() {
            o_frag_color = vec4(texture(u_texture, v_tex_coord).xyz, 1.0);
        }
    `}),w=_t(256,256),ge=a.createTexture();a.bindTexture(a.TEXTURE_2D,ge);a.pixelStorei(a.UNPACK_ALIGNMENT,1);a.texImage2D(a.TEXTURE_2D,0,a.RGB,w.width,w.height,0,a.RGB,a.UNSIGNED_BYTE,w.buffer);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);const B=Ne();let ee=!1;const wt={[_.EMPTY]:P(0),[_.STONE]:nt(0),[_.WOOD]:it(0),[_.SAND]:st(0),[_.DENSE_SAND]:ot(0),[_.WATER]:lt(0),[_.OIL]:ct(0),[_.AIR]:at(0),[_.FIRE]:rt(0)},O={element:_.SAND,size:1,is_paused:!1};ke();Oe(function(e){e.target===S&&e.button===0&&(ee=!0)});Se(function(e){e.code==="KeyR"&&pe(w,P(0)),e.code==="Space"&&(O.is_paused=!O.is_paused,Y(N))});De(function(e){e.target===S&&Ae(B,e.x,e.y)});Le(function(e){e.button===0&&(ee=!1)});Re(function(e){O.size=V(O.size-e.yd,1,32),Y(N)});function xt(){if(ee){const e=Math.floor(B[0]/S.width*w.width),t=Math.floor(B[1]/S.height*w.height);vt(w,wt[O.element],e,t,O.size)}O.is_paused||pt(w)}function It(){a.viewport(0,0,S.width,S.height),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.bindTexture(a.TEXTURE_2D,ge),gt(w),a.texImage2D(a.TEXTURE_2D,0,a.RGB,w.width,w.height,0,a.RGB,a.UNSIGNED_BYTE,w.buffer),a.useProgram(bt),a.drawArrays(a.TRIANGLE_STRIP,0,4)}function ve(){xt(),It(),requestAnimationFrame(ve)}ve();const te=me(N,"General");Qe(te,"Brush Size",Q(O,"size"),1,1,32);je(te,"Is Paused",Q(O,"is_paused"));Je(te,"Reset",function(){pe(w,P(0))});const St=me(N,"Elements");qe(St,"Element",Q(O,"element"),Me(_),Fe(_));Ye(N);
