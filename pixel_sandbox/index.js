(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();let f;function ve(e){return f=e.getContext("webgl2")}function ye(e,t){const n=f.createShader(e);if(!n)return null;if(f.shaderSource(n,t),f.compileShader(n),!f.getShaderParameter(n,f.COMPILE_STATUS)){const s=f.getShaderInfoLog(n);return console.error(s),f.deleteShader(n),null}return n}function we(e){const t=f.createProgram(),n=[];for(const s in e){const o=e[s],l=ye(parseInt(s),o);if(!l){for(const c of n)f.deleteShader(c);return null}n.push(l)}for(const s of n)f.attachShader(t,s);f.linkProgram(t);for(const s of n)f.detachShader(t,s),f.deleteShader(s);if(!f.getProgramParameter(t,f.LINK_STATUS)){const s=f.getProgramInfoLog(t);return console.error(s),f.deleteProgram(t),null}return t}const g={keys:{},buttons:{},kb_key_down:function(){},kb_key_up:function(){},m_move:function(){},m_button_down:function(){},m_button_up:function(){},m_wheel_scroll:function(){}};function be(e){g.kb_key_down=e}function xe(e){g.m_move=e}function Ie(e){g.m_button_down=e}function Se(e){g.m_button_up=e}function De(e){g.m_wheel_scroll=e}function Oe(){addEventListener("keydown",function(e){g.keys[e.code]=0,g.kb_key_down({code:e.code,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,event:e})}),addEventListener("keyup",function(e){g.keys[e.code]=1,g.kb_key_up({code:e.code,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,event:e})}),addEventListener("mousemove",function(e){g.m_move({x:e.offsetX,y:e.offsetY,xd:e.movementX,yd:e.movementY,button:e.button,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,target:e.target,event:e})}),addEventListener("mousedown",function(e){g.buttons[e.button]=0,g.m_button_down({x:e.offsetX,y:e.offsetY,xd:e.movementX,yd:e.movementY,button:e.button,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,target:e.target,event:e})}),addEventListener("mouseup",function(e){g.buttons[e.button]=1,g.m_button_up({x:e.offsetX,y:e.offsetY,xd:e.movementX,yd:e.movementY,button:e.button,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey,target:e.target,event:e})}),addEventListener("wheel",function(e){g.m_wheel_scroll({xd:Math.sign(e.deltaX),yd:Math.sign(e.deltaY),event:e})})}function Le(e,t,n){return Math.min(Math.max(e,t),n)}function ee(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function M(e,t,n){return t*n+e}const le=Float32Array;function Re(e=0,t){const n=new le(2);return n[0]=e,n[1]=e,n}function ke(e,t,n){return e[0]=t,e[1]=n,e}function $(e,t,n){return Math.min(Math.max(e,t),n)}var A=(e=>(e[e.PX=0]="PX",e[e.PCT=1]="PCT",e[e.FR=2]="FR",e))(A||{});const Ne={0:"px",1:"%",2:"fr"};class Ae{}function E(e,t){const n=new Ae;return n.x=e,n.u=t,n}function ze(e){return`${e.x}${Ne[e.u]}`}class Ee{get(){return this.type===0?this.object[this.key]:this.call_get()}set(t){this.type===0?this.object[this.key]=t:this.call_set(t)}}function B(e,t){const n=new Ee;return n.type=0,n.object=e,n.key=t,n}function Xe(e){const t=Object.values(e);return t.slice(0,t.length/2).map(n=>String(n))}function Fe(e){const t=Object.keys(e);return t.slice(0,t.length/2).map(n=>Number(n))}function N(e,t){if(!e)return null;const n=document.createElement("span");return n.className="gui_label",n.innerHTML=e,t.append(n),n}function F(){const e=document.createElement("div");return e.className="gui_container",e}function G(e,t,n,i,s){const o=document.createElement("input");return o.className="gui_input",o.type=e,o.step=n.toString(),o.min=i.toString(),o.max=s.toString(),o.value=t.toString(),o}class v{constructor(){this.children=[]}container(){return this.ref_el}render(){}mount(){}static mount(){}update(){}}class ce extends v{grid_str(t){let n="";for(let i=0;i<t.length;i+=1){const s=t[i];n+=ze(s),i<t.length-1&&(n+=" ")}return n}layout_str(){let t="";const n=this.grid_x.length,i=this.grid_y.length,s=n*i;for(let o=0;o<s;o+=n){let l="";for(let c=o;c<o+n;c+=1){const r=this.layout[c];l+=`w${r}`,c<o+n-1&&(l+=" ")}t+=`"${l}"
`}return t}render(){const t=document.createElement("div");this.window_parent?t.className="gui_window":t.className="gui_window_root",this.window_children.length?(t.style.display="grid",t.style.gridTemplateColumns=this.grid_str(this.grid_x),t.style.gridTemplateRows=this.grid_str(this.grid_y),t.style.gridTemplateAreas=this.layout_str()):t.style.gridArea=`w${this.id}`,this.ref_el=t}}class j extends v{container(){return this.container_el}render(){const t=document.createElement("div");t.className="gui_collapsing_header"+(this.is_collapsed?" gui_is_collapsed":"");const n=document.createElement("div");n.className="gui_title",n.innerHTML=this.title,t.append(n),n.onclick=(function(){this.is_collapsed?(this.is_collapsed=!1,t.classList.remove("gui_is_collapsed")):(this.is_collapsed=!0,t.classList.add("gui_is_collapsed"))}).bind(this);const i=F();t.append(i),this.ref_el=t,this.container_el=i}}class Pe extends v{render(){const t=document.createElement("div");t.className="gui_text",t.innerHTML=this.value,this.ref_el=t}}class ae extends v{render(){const t=document.createElement("div");t.className="gui_bool";const n=document.createElement("div");n.className="gui_checkbox_group_option"+(this.value.get()?" gui_selected":""),n.innerHTML=this.label,t.append(n),n.onclick=(function(){this.value.get()?(this.value.set(!1),n.classList.remove("gui_selected")):(this.value.set(!0),n.classList.add("gui_selected")),this.onchange(this.value.get())}).bind(this),this.ref_el=t,this.input_el=n}update(){this.value.get()?this.input_el.classList.add("gui_selected"):this.input_el.classList.remove("gui_selected")}}class Ue extends v{render(){const t=document.createElement("div");t.className="gui_input_number",N(this.label,t);const n=G("number",this.value.get(),this.step,this.min,this.max);t.append(n),n.onchange=(function(){const i=$(parseFloat(n.value),this.min,this.max);this.value.set(i),n.value=i.toString(),this.onchange(i)}).bind(this),this.ref_el=t,this.input_el=n}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.value.get().toString())}}class re extends v{render(){const t=document.createElement("div");t.className="gui_slider_number",N(this.label,t);const n=F();n.className="gui_input_range_container",t.append(n);const i=G("range",this.value.get(),this.step,this.min,this.max);i.className="gui_input_range",n.dataset.content=i.value,n.append(i),i.onchange=(function(){const s=$(parseFloat(i.value),this.min,this.max);this.value.set(s),n.dataset.content=i.value,this.onchange(s)}).bind(this),i.onmousemove=function(){n.dataset.content=i.value},this.ref_el=t,this.container_el=n,this.input_el=i}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.value.get().toString(),this.container_el.dataset.content=this.input_el.value)}}class Ve extends v{render(){const t=document.createElement("div");t.className="gui_input_vec",t.style.setProperty("--size",this.size.toString()),N(this.label,t);const n=F();t.append(n);const i=[];for(let s=0;s<this.value.length;s+=1){const o=G("number",this.value[s],this.step,this.min,this.max);n.append(o),o.onchange=(function(){const l=$(parseFloat(o.value),this.min,this.max);this.value[s]=l,o.value=l.toString(),this.onchange(this.value)}).bind(this),i.push(o)}this.ref_el=t,this.input_els=i}update(){for(let t=0;t<this.value.length;t+=1){const n=this.input_els[t];document.activeElement!=n&&(n.value=this.value[t].toString())}}}class Me extends v{to_hex(t,n,i){const s=this.mode===0?255:1,o=Math.round(t*s).toString(16).padStart(2,"0"),l=Math.round(n*s).toString(16).padStart(2,"0"),c=Math.round(i*s).toString(16).padStart(2,"0");return`#${o}${l}${c}`}from_hex(t){const n=t.replace(/^#/,""),i=this.mode===0?255:1,s=parseInt(n.substring(0,2),16)/i,o=parseInt(n.substring(2,4),16)/i,l=parseInt(n.substring(4,6),16)/i;return[s,o,l]}render(){const t=document.createElement("div");t.className="gui_color_edit"+(this.value.length===4?" gui_rgba":""),N(this.label,t);const n=F();t.append(n);const i=document.createElement("input");if(i.className="gui_input_color",i.type="color",i.value=this.to_hex(this.value[0],this.value[1],this.value[2]),n.append(i),i.onchange=(function(){const s=this.from_hex(i.value);this.value[0]=s[0],this.value[1]=s[1],this.value[2]=s[2],this.onchange(this.value)}).bind(this),this.value.length==4){const s=document.createElement("div");s.className="gui_input_range_container",n.append(s);const o=G("range",this.value[3],.01,0,1);o.className="gui_input_range",s.dataset.content=o.value,s.append(o),o.onchange=(function(){this.value[3]=parseFloat(o.value)*(this.mode===1?255:1),s.dataset.content=o.value,this.onchange(this.value)}).bind(this),o.onmousemove=function(){s.dataset.content=o.value},this.range_el=o,this.range_container_el=s}this.ref_el=t,this.input_el=i}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.to_hex(this.value[0],this.value[1],this.value[2])),this.range_container_el&&this.range_el&&document.activeElement!=this.range_el&&(this.range_el.value=this.value[3].toString(),this.range_container_el.dataset.content=this.range_el.value)}}class Ge extends v{render(){const t=document.createElement("div");t.className="gui_input_text",N(this.label,t);const n=document.createElement("input");n.className="gui_input",n.type="text",n.value=this.value.get().toString(),t.append(n),n.onchange=(function(){this.value.set(n.value),this.onchange(n.value)}).bind(this),this.ref_el=t,this.input_el=n}update(){document.activeElement!=this.input_el&&(this.input_el.value=this.value.get().toString())}}class He extends v{render(){const t=document.createElement("div");t.className="gui_radio_group",N(this.label,t);const n=F();t.append(n);const i=[],s=this.value.get();for(let o=0;o<this.keys.length;o+=1){const l=this.keys[o],c=this.values[o],r=document.createElement("div");r.className="gui_radio_group_option"+(c===s?" gui_selected":""),r.innerHTML=l,n.append(r),r.onclick=(function(){this.value.set(c);for(const m of this.option_els)m.classList.remove("gui_selected");r.classList.add("gui_selected"),this.onchange(c)}).bind(this),i.push(r)}this.ref_el=t,this.option_els=i}update(){const t=this.value.get();for(let n=0;n<this.option_els.length;n+=1){const i=this.option_els[n];this.values[n]===t?i.classList.add("gui_selected"):i.classList.remove("gui_selected")}}}class Ke extends v{render(){const t=document.createElement("div");t.className="gui_checkbox_group",N(this.label,t);const n=F();t.append(n);const i=[],s=this.value.get();for(let o=0;o<this.keys.length;o+=1){const l=this.keys[o],c=this.values[o],r=document.createElement("div");r.className="gui_checkbox_group_option"+(s.indexOf(c)>-1?" gui_selected":""),r.innerHTML=l,n.append(r),r.onclick=(function(){r.classList.contains("gui_selected")?(s.splice(s.indexOf(c),1),r.classList.remove("gui_selected")):(s.push(c),r.classList.add("gui_selected")),this.onchange(this.value.get())}).bind(this),i.push(r)}this.ref_el=t,this.option_els=i}update(){const t=this.value.get();for(let n=0;n<this.option_els.length;n+=1){const i=this.option_els[n];t.indexOf(this.values[n])>-1?i.classList.add("gui_selected"):i.classList.remove("gui_selected")}}}class ue extends v{render(){const t=document.createElement("div");t.className="gui_select",N(this.label,t);const n=document.createElement("div");n.className="gui_select",t.append(n),n.onclick=function(c){c.stopPropagation()};const i=document.createElement("div");i.className="gui_select_button",i.innerHTML="Select",n.append(i),i.onclick=function(){i.classList.contains("gui_open")?i.classList.remove("gui_open"):i.classList.add("gui_open")};const s=document.createElement("div");s.className="gui_select_container",n.append(s);const o=[],l=this.value.get();for(let c=0;c<this.keys.length;c+=1){const r=this.keys[c];this.values[c]===l&&(i.innerHTML=r);const _=document.createElement("div");_.className="gui_select_option",_.innerHTML=r,_.dataset.value=c.toString(),s.append(_),_.onclick=(function(){const b=this.values[parseInt(_.dataset.value||"")];this.value.set(b),i.innerHTML=r,i.classList.remove("gui_open"),this.onchange(b)}).bind(this),o.push(_)}this.ref_el=t,this.button_el=i,this.option_els=o}static mount(){const t=document.body.querySelector(".gui_window_root");t&&t.addEventListener("click",function(){const n=document.body.querySelector(".gui_select_button.gui_open");n&&n.classList.remove("gui_open")})}update(){const t=this.value.get();for(let n=0;n<this.option_els.length;n+=1)if(this.values[n]===t){this.button_el.innerHTML=this.keys[n];return}}}class _e extends v{render(){const t=document.createElement("div");t.className="gui_button";const n=document.createElement("button");n.innerHTML=this.label,n.onclick=this.onclick,t.append(n),this.ref_el=t}}class de extends v{render(){const t=document.createElement("div");t.className="gui_canvas";const n=this.canvas_el??document.createElement("canvas");t.append(n),this.auto_resize&&window.addEventListener("resize",function(){var i,s;n.width=((i=n.parentElement)==null?void 0:i.clientWidth)||0,n.height=((s=n.parentElement)==null?void 0:s.clientHeight)||0}),this.ref_el=t,this.canvas_el=n}mount(){var t,n;this.auto_resize&&(this.canvas_el.width=((t=this.canvas_el.parentElement)==null?void 0:t.clientWidth)||0,this.canvas_el.height=((n=this.canvas_el.parentElement)==null?void 0:n.clientHeight)||0)}}const Te=[ce,j,Pe,ae,Ue,re,Ve,Me,Ge,He,Ke,ue,_e,de];let te=0;function Q(e,t=""){const n=new ce;return n.id=te,n.title=t,n.grid_x=[],n.grid_y=[],n.layout=[],n.window_parent=e,n.window_children=[],n.parent=e,e&&(e.children.push(n),e.window_children.push(n)),te+=1,n}function We(e,t,n){e.grid_x=t,e.grid_y=n}function Ce(e,t){const n=[];for(const i of t)n.push(i.id);e.layout=n}function $e(e,t,n=!1){const i=new j;return i.title=t,i.is_collapsed=n,i.parent=e,e&&e.children.push(i),i}function Be(e,t,n,i=()=>{}){const s=new ae;return s.label=t,s.value=n,s.onchange=i,s.parent=e,e&&e.children.push(s),s}function je(e,t,n,i,s,o,l=()=>{}){const c=new re;return c.label=t,c.value=n,c.step=i,c.min=s,c.max=o,c.onchange=l,c.parent=e,e&&e.children.push(c),c}function Qe(e,t,n,i,s,o=()=>{}){const l=new ue;return l.label=t,l.value=n,l.keys=i,l.values=s,l.onchange=o,l.parent=e,e&&e.children.push(l),l}function qe(e,t,n){const i=new _e;return i.label=t,i.onclick=n,i.parent=e,e&&e.children.push(i),i}function Je(e,t=!0){const n=new de;return n.auto_resize=t,n.parent=e,e&&e.children.push(n),n}function q(e,t){e.render(),t.append(e.ref_el),e.mount();for(const n of e.children)q(n,e.container())}function Ze(e){var i;if(!((i=e.parent)==null?void 0:i.ref_el))return;const n=e.ref_el;e.render(),n.replaceWith(e.ref_el),e.mount();for(const s of e.children)q(s,e.container())}function Ye(e,t,n=!0){if(q(e,t),!!n)for(const i of Te)i.mount()}function J(e){if(!(e instanceof j&&e.is_collapsed)){e.update();for(const t of e.children)J(t)}}function S(e=0,t,n){const i=new le(3);return i[0]=e,i[1]=t??e,i[2]=n??e,i}function D(e){return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255}var u=(e=>(e[e.VOID=0]="VOID",e[e.SOLID=1]="SOLID",e[e.LIQUID=2]="LIQUID",e[e.GAS=3]="GAS",e))(u||{});class O{}function P(e,t){e.type=t.type,e.color=t.color,e.state=t.state,e.gravity_flag=t.gravity_flag,e.density=t.density,e.lifetime=t.lifetime,e.temperature=t.temperature}var h=(e=>(e[e.EMPTY=0]="EMPTY",e[e.STONE=1]="STONE",e[e.WOOD=2]="WOOD",e[e.SAND=3]="SAND",e[e.DENSE_SAND=4]="DENSE_SAND",e[e.WATER=5]="WATER",e[e.OIL=6]="OIL",e[e.AIR=7]="AIR",e[e.FIRE=8]="FIRE",e))(h||{});const et={0:S(235,235,235),1:S(99,99,99),2:S(161,102,47),3:S(247,201,136),4:S(209,155,105),5:S(82,133,235),6:S(77,75,38),7:S(169,205,222),8:S(255,92,51)};function L(e){return et[e]}function X(e){const t=new O;return t.id=e,t.type=0,t.color=D(L(t.type)),t.state=u.VOID,t.gravity_flag=!1,t.density=0,t.lifetime=0,t}function tt(e){const t=new O;return t.id=e,t.type=1,t.color=D(L(t.type)),t.state=u.SOLID,t.gravity_flag=!1,t.density=1,t.lifetime=0,t}function nt(e){const t=new O;return t.id=e,t.type=2,t.color=D(L(t.type)),t.state=u.SOLID,t.gravity_flag=!1,t.density=1,t.lifetime=0,t}function it(e){const t=new O;return t.id=e,t.type=3,t.color=D(L(t.type)),t.state=u.SOLID,t.gravity_flag=!0,t.density=2,t.lifetime=0,t}function st(e){const t=new O;return t.id=e,t.type=4,t.color=D(L(t.type)),t.state=u.SOLID,t.gravity_flag=!0,t.density=1,t.lifetime=0,t}function ot(e){const t=new O;return t.id=e,t.type=5,t.color=D(L(t.type)),t.state=u.LIQUID,t.gravity_flag=!0,t.density=3,t.lifetime=0,t}function lt(e){const t=new O;return t.id=e,t.type=6,t.color=D(L(t.type)),t.state=u.LIQUID,t.gravity_flag=!0,t.density=4,t.lifetime=0,t}function ct(e){const t=new O;return t.id=e,t.type=7,t.color=D(L(t.type)),t.state=u.GAS,t.gravity_flag=!0,t.density=4,t.lifetime=0,t}function at(e){const t=new O;return t.id=e,t.type=8,t.color=D(L(t.type)),t.state=u.GAS,t.gravity_flag=!0,t.density=4,t.lifetime=400,t}class rt{}function ut(e,t){const n=e*t,i=new rt;i.width=e,i.height=t,i.size=n,i.elements=new Array(n),i.buffer=new Uint8Array(n*3);for(let s=0;s<n;s+=1){const o=X(s);i.elements[s]=X(s),i.buffer[s*3]=o.color>>16&255,i.buffer[s*3+1]=o.color>>8&255,i.buffer[s*3+2]=o.color&255}return i}function U(e,t){return e.elements[t]}function ne(e,t){return e.elements[(t-1+e.size)%e.size]}function ie(e,t){return e.elements[(t+1)%e.size]}function se(e,t){return e.elements[(t+e.width)%e.size]}function _t(e,t){return e.elements[(t-e.width+e.size)%e.size]}function K(e,t){return e.elements[(t-1+e.width)%e.size]}function dt(e,t){return e.elements[(t-1-e.width+e.size)%e.size]}function T(e,t){return e.elements[(t+1+e.width)%e.size]}function ht(e,t){return e.elements[(t+1-e.width+e.size)%e.size]}function y(e,t,n){e.elements[t.id]=n,e.elements[n.id]=t;const i=t.id;t.id=n.id,n.id=i}const ft=X(0);let oe=0;function mt(e){oe+=1;for(let t=e.height-1;t>=0;t-=1){const n=Math.random()<.5;for(let i=0;i<e.width;i+=1){const s=M(n?i:e.width-1-i,t,e.width),o=U(e,s),l=se(e,s),c=n?K(e,s):T(e,s),r=n?T(e,s):K(e,s),m=ne(e,s),_=ie(e,s);o.state!==u.VOID&&(!o.gravity_flag||s>=e.size-e.width-1||(o.state===u.SOLID&&(l.state===u.VOID?y(e,o,l):c.state===u.VOID?y(e,o,c):r.state===u.VOID?y(e,o,r):l.density>o.density&&l.gravity_flag&&y(e,o,l)),o.state===u.LIQUID&&(l.state===u.VOID?y(e,o,l):c.state===u.VOID?y(e,o,c):r.state===u.VOID?y(e,o,r):l.density>o.density&&l.gravity_flag?y(e,o,l):m.state===u.VOID?y(e,o,m):_.state===u.VOID?y(e,o,_):m.density>o.density&&m.gravity_flag&&m.state===u.LIQUID?y(e,o,m):_.density>o.density&&_.gravity_flag&&_.state===u.LIQUID&&y(e,o,_))))}}for(let t=0;t<e.height;t+=1){const n=Math.random()<.5;for(let i=0;i<e.width;i+=1){const s=M(n?i:e.width-1-i,t,e.width),o=U(e,s),l=ne(e,s),c=ie(e,s),r=_t(e,s),m=dt(e,s),_=ht(e,s),b=se(e,s),pe=K(e,s),ge=T(e,s);if(o.state!==u.VOID){if(o.type===h.FIRE){o.lifetime-=ee(-1,8);const d=[l,c,r,m,_,b,pe,ge],p=d[ee(0,d.length-1)];(p.type===h.WOOD||p.type===h.OIL)&&Math.random()>.5&&(P(p,o),p.lifetime=200),(o.lifetime<=0||p.type===h.WATER)&&P(o,ft)}if(oe%4!==0)return;if(!(!o.gravity_flag||s<e.width)&&!(b.type===h.WOOD||b.type===h.OIL)&&o.state===u.GAS){const d=[];r.state===u.VOID&&d.push(r),m.state===u.VOID&&d.push(m),_.state===u.VOID&&d.push(_),r.density<o.density&&r.gravity_flag&&d.push(r),l.state===u.VOID&&d.push(l),c.state===u.VOID&&d.push(c),l.density<o.density&&l.gravity_flag&&l.state===u.GAS&&d.push(l),c.density<o.density&&c.gravity_flag&&c.state===u.GAS&&d.push(c),Math.random()<.05&&b.state===u.VOID&&d.push(b);for(let p=d.length-1;p>0;p--){const Y=Math.floor(Math.random()*(p+1));[d[p],d[Y]]=[d[Y],d[p]]}for(let p=0;p<d.length;p++)if(d[p]!==null){y(e,o,d[p]);break}}}}}}function pt(e){for(let t=0;t<e.size;t+=1){const n=U(e,t);e.buffer[t*3]=n.color>>16&255,e.buffer[t*3+1]=n.color>>8&255,e.buffer[t*3+2]=n.color&255}}function gt(e,t,n,i,s){if(s<=1){const o=M(n,i,e.width),l=U(e,o);if(!l)return;P(l,t)}else{const o=Math.floor(s/2);for(let l=-o;l<=o;l++)for(let c=-o;c<=o;c++){const r=n+c,m=i+l;if(!(r<0||r>=e.width||m<0||m>=e.height)&&c*c+l*l<=o*o){const _=M(r,m,e.width),b=U(e,_);if(!b)continue;P(b,t)}}}}function he(e,t){for(const n of e.elements)P(n,t)}const V=Q(null);We(V,[E(300,A.PX),E(1,A.FR),E(300,A.PX)],[E(1,A.FR),E(1,A.FR),E(1,A.FR)]);const z=Q(V),R=Q(V);Ce(V,[z,R,R,z,R,R,z,R,R]);const vt=Je(R,!1);Ye(V,document.body);const k=R.ref_el,x=vt.canvas_el;let W=k.clientWidth<k.clientHeight?k.clientWidth:k.clientHeight;x.width=x.height=W;addEventListener("resize",function(){W=k.clientWidth<k.clientHeight?k.clientWidth:k.clientHeight,x.width=x.height=W});const a=ve(x),yt=we({[a.VERTEX_SHADER]:`#version 300 es
        out vec2 v_tex_coord;

        const vec2 positions[4] = vec2[](
            vec2(-1.0, 1.0),
            vec2(-1.0, -1.0),
            vec2(1.0, 1.0),
            vec2(1.0, -1.0)
        );

        const vec2 tex_coords[4] = vec2[](
            vec2(0.0, 0.0),
            vec2(0.0, 1.0),
            vec2(1.0, 0.0),
            vec2(1.0, 1.0)
        );

        void main() {
            gl_Position = vec4(positions[gl_VertexID], 0.0, 1.0);
            v_tex_coord = tex_coords[gl_VertexID];
        }
    `,[a.FRAGMENT_SHADER]:`#version 300 es
        precision highp float;
        out vec4 o_frag_color;
        in vec2 v_tex_coord;
        uniform sampler2D u_texture;

        void main() {
            o_frag_color = vec4(texture(u_texture, v_tex_coord).xyz, 1.0);
        }
    `}),w=ut(256,256),fe=a.createTexture();a.bindTexture(a.TEXTURE_2D,fe);a.pixelStorei(a.UNPACK_ALIGNMENT,1);a.texImage2D(a.TEXTURE_2D,0,a.RGB,w.width,w.height,0,a.RGB,a.UNSIGNED_BYTE,w.buffer);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);const C=Re();let Z=!1;const wt={[h.EMPTY]:X(0),[h.STONE]:tt(0),[h.WOOD]:nt(0),[h.SAND]:it(0),[h.DENSE_SAND]:st(0),[h.WATER]:ot(0),[h.OIL]:lt(0),[h.AIR]:ct(0),[h.FIRE]:at(0)},I={element:h.SAND,size:1,is_paused:!1};Oe();Ie(function(e){e.target===x&&e.button===0&&(Z=!0)});be(function(e){e.code==="KeyR"&&he(w,X(0)),e.code==="Space"&&(I.is_paused=!I.is_paused,J(z))});xe(function(e){e.target===x&&ke(C,e.x,e.y)});Se(function(e){e.button===0&&(Z=!1)});De(function(e){I.size=Le(I.size-e.yd,1,32),J(z)});function bt(){if(Z){const e=Math.floor(C[0]/x.width*w.width),t=Math.floor(C[1]/x.height*w.height);gt(w,wt[I.element],e,t,I.size)}I.is_paused||mt(w)}function xt(){a.viewport(0,0,x.width,x.height),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.bindTexture(a.TEXTURE_2D,fe),pt(w),a.texImage2D(a.TEXTURE_2D,0,a.RGB,w.width,w.height,0,a.RGB,a.UNSIGNED_BYTE,w.buffer),a.useProgram(yt),a.drawArrays(a.TRIANGLE_STRIP,0,4)}function me(){bt(),xt(),requestAnimationFrame(me)}me();const H=$e(z,"General");Qe(H,"Element",B(I,"element"),Xe(h),Fe(h));je(H,"Brush Size",B(I,"size"),1,1,32);Be(H,"Is Paused",B(I,"is_paused"));qe(H,"Reset",function(){he(w,X(0))});Ze(z);
